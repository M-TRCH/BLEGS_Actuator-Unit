# üîß Troubleshooting Guide

‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö BLEGS Actuator Unit

---

## üìã ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

- [‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Hardware](#‡∏õ‡∏±‡∏ç‡∏´‡∏≤-hardware)
- [‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Communication](#‡∏õ‡∏±‡∏ç‡∏´‡∏≤-communication)
- [‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Motor](#‡∏õ‡∏±‡∏ç‡∏´‡∏≤-motor)
- [‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Software](#‡∏õ‡∏±‡∏ç‡∏´‡∏≤-software)
- [LED Error Codes](#led-error-codes)
- [Diagnostic Tools](#diagnostic-tools)

---

## ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Hardware

### ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ Serial Output

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:**
- ‡πÄ‡∏õ‡∏¥‡∏î Serial Monitor ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏™‡∏î‡∏á
- ‡πÑ‡∏°‡πà‡∏°‡∏µ response ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ:**

1. **COM Port ‡∏ú‡∏¥‡∏î**
   ```
   ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Device Manager (Windows)
   - ‡πÉ‡∏ä‡πâ `ls /dev/tty*` (Linux/Mac)
   - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô COM port ‡πÉ‡∏ô Serial Monitor
   ```

2. **Baud Rate ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á**
   ```
   ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
   - ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ baud rate = 921,600
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏ô Serial Monitor settings
   - ‡∏•‡∏≠‡∏á baud rate ‡∏≠‡∏∑‡πà‡∏ô‡πÜ (115200, 9600)
   ```

3. **TX/RX ‡∏™‡∏•‡∏±‡∏ö‡∏Å‡∏±‡∏ô**
   ```
   ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
   - ‡∏™‡∏•‡∏±‡∏ö‡∏™‡∏≤‡∏¢ TX ‚Üî RX
   - USB Adapter TX ‚Üí MCU RX
   - USB Adapter RX ‚Üí MCU TX
   ```

4. **‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠ GND ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô**
   ```
   ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
   - ‡∏ï‡πà‡∏≠ GND ‡∏Ç‡∏≠‡∏á USB adapter ‡∏Å‡∏±‡∏ö MCU
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ multimeter
   ```

5. **MCU ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô**
   ```
   ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö power supply (3.3V)
   - ‡∏Å‡∏î reset button
   - Upload firmware ‡πÉ‡∏´‡∏°‡πà
   ```

---

### ‚ùå LED ‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏¥‡∏î‡∏ú‡∏¥‡∏î‡∏™‡∏µ

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:**
- LED ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏•‡∏¢
- ‡∏™‡∏µ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
- ‡∏™‡∏µ‡∏Å‡∏£‡∏∞‡∏û‡∏£‡∏¥‡∏ö‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**

1. **LED ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠**
   ```
   ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:
   - LED VCC ‚Üí 3.3V or 5V
   - LED GND ‚Üí GND
   - LED DIN ‚Üí PB0
   ```

2. **LED ‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô**
   ```
   ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
   - ‡πÉ‡∏ä‡πâ WS2812B ‡∏´‡∏£‡∏∑‡∏≠ compatible
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö datasheet
   ```

3. **Voltage ‡πÑ‡∏°‡πà‡∏û‡∏≠**
   ```
   ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
   - ‡πÉ‡∏ä‡πâ 5V ‡πÅ‡∏ó‡∏ô 3.3V
   - ‡πÄ‡∏û‡∏¥‡πà‡∏° level shifter
   ```

4. **‡πÑ‡∏°‡πà‡∏°‡∏µ capacitor**
   ```
   ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
   - ‡πÄ‡∏û‡∏¥‡πà‡∏° 100¬µF capacitor ‡∏Ç‡πâ‡∏≤‡∏° VCC-GND
   ```

---

### ‚ùå Encoder ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:**
```
[ERROR] AS5047P not detected
[ERROR] SPI communication failed
```

**‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**

1. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö SPI Connections**
   ```
   Encoder VDD  ‚Üí 3.3V (or 5V)
   Encoder GND  ‚Üí GND
   Encoder CLK  ‚Üí PA5
   Encoder MISO ‚Üí PA6
   Encoder MOSI ‚Üí PA7
   Encoder CS   ‚Üí PA4
   ```

2. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Voltage**
   ```
   ‡πÉ‡∏ä‡πâ multimeter ‡∏ß‡∏±‡∏î:
   - VDD: 3.3V ¬± 0.1V (or 5.0V ¬± 0.2V)
   - GND: 0V
   ```

3. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Magnet Position**
   ```
   ‚úÖ ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á: 0.5-2.0 mm (optimal ~1.0 mm)
   ‚úÖ ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á: magnet ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á sensor
   ‚úÖ Polarity: ‡πÉ‡∏ä‡πâ diametric magnet
   ```

4. **‡∏•‡∏î SPI Clock Speed**
   ```cpp
   // ‡πÉ‡∏ô encoder.cpp
   SPI.beginTransaction(SPISettings(1000000, MSBFIRST, SPI_MODE1));
   // ‡∏•‡∏î‡∏à‡∏≤‡∏Å 10 MHz ‚Üí 1 MHz
   ```

---

## ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Communication

### ‚ùå CRC Failed

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:**
```python
[RX] CRC Failed! Expected: 0xABCD, Got: 0x1234
```

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**

1. **Noise ‡∏ö‡∏ô‡∏™‡∏≤‡∏¢ Serial**
   ```
   ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
   - ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏¢‡∏™‡∏±‡πâ‡∏ô‡πÜ (< 1 ‡πÄ‡∏°‡∏ï‡∏£)
   - ‡πÉ‡∏ä‡πâ shielded cable
   - ‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å motor wires
   ```

2. **USB Latency Timer ‡∏™‡∏π‡∏á**
   ```
   ‚úÖ Windows:
   1. Device Manager ‚Üí Ports ‚Üí USB Serial Port
   2. Properties ‚Üí Port Settings ‚Üí Advanced
   3. ‡∏ï‡∏±‡πâ‡∏á Latency Timer = 1 ms
   ```

3. **Baud Rate ‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤**
   ```
   ‚úÖ ‡∏•‡∏≠‡∏á baud rate ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤:
   - 460,800
   - 230,400
   - 115,200
   ```

---

### ‚ùå No Response from Binary Commands

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:**
- ‡∏™‡πà‡∏á binary packet ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà‡∏°‡∏µ response
- Timeout error

**‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**

1. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Binary Mode ‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà**
   ```
   ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á ASCII:
   B
   
   Response:
   Binary mode: ENABLED
   ```

2. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Packet Format**
   ```python
   # ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ header 0xFE 0xEE
   packet = [0xFE, 0xEE, type, length, ...payload, crc_l, crc_h]
   ```

3. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö CRC Calculation**
   ```python
   # ‡πÉ‡∏ä‡πâ CRC-16/MODBUS
   def crc16(data):
       crc = 0xFFFF
       for byte in data:
           crc ^= byte
           for _ in range(8):
               if crc & 0x0001:
                   crc = (crc >> 1) ^ 0xA001
               else:
                   crc >>= 1
       return crc
   ```

4. **‡πÄ‡∏û‡∏¥‡πà‡∏° Timeout**
   ```python
   port = serial.Serial('COM44', 921600, timeout=1.0)  # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô 1 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
   ```

---

## ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Motor

### ‚ùå ‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏´‡∏°‡∏∏‡∏ô

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:**
- ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà
- ‡πÑ‡∏°‡πà‡∏°‡∏µ error message

**‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**

1. **‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Å‡∏î START**
   ```
   ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
   - ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° START ‡∏ö‡∏ô‡∏ö‡∏≠‡∏£‡πå‡∏î
   - ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á 'S' ‡∏ú‡πà‡∏≤‡∏ô Serial
   ```

2. **‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ = ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô**
   ```
   ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
   - ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö feedback: "Returns: X.X  Y.Y"
   ```

3. **24V Power ‡πÑ‡∏°‡πà‡∏°‡∏µ**
   ```
   ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:
   - ‡∏ß‡∏±‡∏î‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ó‡∏µ‡πà V_MOTOR terminal
   - ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ 24V ¬± 1V
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö fuse/breaker
   ```

4. **Motor Driver ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô**
   ```
   ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:
   - ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á phase (1-10 Œ©)
   - ‡πÑ‡∏°‡πà‡∏°‡∏µ short circuit
   - MOSFET ‡πÑ‡∏°‡πà‡πÑ‡∏´‡∏°‡πâ
   ```

---

### ‚ùå ‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡∏Å ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏±‡πà‡∏ô

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:**
- ‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏ô‡∏∏‡πà‡∏°‡∏ô‡∏ß‡∏•
- ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏î‡∏±‡∏á‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥
- ‡∏™‡∏±‡πà‡∏ô‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤

**‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**

1. **‡πÉ‡∏ä‡πâ S-Curve Mode**
   ```
   M1    # ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô S-Curve
   ```

2. **PID Gains ‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°**
   ```cpp
   // ‡πÉ‡∏ô motor_control.h ‡∏´‡∏£‡∏∑‡∏≠ pid_controller.h
   // ‡∏•‡∏î‡∏Ñ‡πà‡∏≤ Kp, Ki, Kd ‡∏•‡∏á
   #define PID_KP  10.0f   // ‡∏•‡∏î‡∏à‡∏≤‡∏Å 20.0
   #define PID_KI  0.5f    // ‡∏•‡∏î‡∏à‡∏≤‡∏Å 1.0
   #define PID_KD  0.1f    // ‡∏•‡∏î‡∏à‡∏≤‡∏Å 0.5
   ```

3. **Phase Wiring ‡∏ú‡∏¥‡∏î**
   ```
   ‚úÖ ‡∏•‡∏≠‡∏á‡∏™‡∏•‡∏±‡∏ö phase:
   - ‡∏™‡∏•‡∏±‡∏ö A ‚Üî B
   - ‡∏´‡∏£‡∏∑‡∏≠ B ‚Üî C
   - ‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÉ‡∏ô‡∏™‡∏≤‡∏°‡πÅ‡∏ö‡∏ö‡∏à‡∏∞‡∏ô‡∏∏‡πà‡∏°‡∏ô‡∏ß‡∏•
   ```

4. **Encoder Noise**
   ```
   ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö magnet alignment
   - ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏¢ SPI ‡∏™‡∏±‡πâ‡∏ô‡πÜ
   - ‡πÄ‡∏û‡∏¥‡πà‡∏° capacitor ‡∏ó‡∏µ‡πà encoder VCC
   ```

---

### ‚ùå ‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏´‡∏°‡∏∏‡∏ô‡∏ú‡∏¥‡∏î‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:**
- ‡∏™‡πà‡∏á #90 ‡πÅ‡∏ï‡πà‡∏´‡∏°‡∏∏‡∏ô‡πÑ‡∏õ -90

**‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**

```cpp
// ‡πÉ‡∏ô motor_control.cpp ‡∏´‡∏£‡∏∑‡∏≠ encoder.cpp
// ‡∏™‡∏•‡∏±‡∏ö‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á encoder
angle = -angle;  // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ

// ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏•‡∏±‡∏ö 2 phase ‡∏Ç‡∏≠‡∏á‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå
```

---

### ‚ùå ‡∏Ñ‡πà‡∏≤ Position ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:**
- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ #90 ‡πÅ‡∏ï‡πà feedback ‡πÅ‡∏™‡∏î‡∏á #85
- Position drift ‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤

**‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**

1. **‡∏ó‡∏≥ Calibration ‡πÉ‡∏´‡∏°‡πà**
   ```
   1. Reset ‡∏ö‡∏≠‡∏£‡πå‡∏î
   2. ‡∏´‡∏°‡∏∏‡∏ô‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠‡πÑ‡∏õ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á calibration
   3. ‡∏£‡∏≠ LED ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
   4. ‡∏Å‡∏î START
   ```

2. **GEAR_RATIO ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á**
   ```cpp
   // ‡πÉ‡∏ô motor_conf.h
   #define GEAR_RATIO  8.0f  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
   ```

3. **Multi-turn Tracking ‡∏´‡∏•‡∏∏‡∏î**
   ```
   ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
   - ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• EEPROM (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
   - Re-calibrate
   - ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏¥‡∏î-‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏≠‡∏ô‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏´‡∏°‡∏∏‡∏ô
   ```

---

## ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Software

### ‚ùå Build Error

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:**
```
fatal error: protocol.h: No such file or directory
```

**‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**

```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô include/
ls include/

# Clean ‡πÅ‡∏•‡∏∞ rebuild
pio run --target clean
pio run
```

---

### ‚ùå Upload Failed

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:**
```
Error: Could not open COM port
Error: No STLink found
```

**‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**

1. **COM Port ‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô**
   ```
   ‚úÖ ‡∏õ‡∏¥‡∏î Serial Monitor ‡∏Å‡πà‡∏≠‡∏ô upload
   ```

2. **Driver ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á**
   ```
   ‚úÖ ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á:
   - STM32 USB Driver
   - CH340 Driver (‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ CH340)
   ```

3. **Board ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô Bootloader Mode**
   ```
   ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
   - ‡∏Å‡∏î reset button
   - ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏¥‡∏î-‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà
   ```

---

### ‚ùå Python Script Error

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:**
```python
ModuleNotFoundError: No module named 'serial'
```

**‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**

```bash
# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á pyserial
pip install pyserial

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
python -c "import serial; print(serial.VERSION)"
```

---

## LED Error Codes

| ‡∏™‡∏µ | ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢ | ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç |
|----|--------|----------|----------|
| üî¥ ‡πÅ‡∏î‡∏á | ‡∏Å‡∏£‡∏∞‡∏û‡∏£‡∏¥‡∏ö‡πÄ‡∏£‡πá‡∏ß | Critical Error | Reset ‡∏ö‡∏≠‡∏£‡πå‡∏î, ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö hardware |
| üî¥ ‡πÅ‡∏î‡∏á | ‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡∏á‡∏ó‡∏µ‡πà | ‡∏°‡∏∏‡∏°‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á calibration | ‡∏´‡∏°‡∏∏‡∏ô‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á |
| üü† ‡∏™‡πâ‡∏° | ‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡∏á‡∏ó‡∏µ‡πà | Warning (overcurrent, overheat) | ‡∏£‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏¢‡πá‡∏ô, ‡∏•‡∏î‡πÇ‡∏´‡∏•‡∏î |
| üü° ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á | ‡∏´‡∏≤‡∏¢‡πÉ‡∏à | ‡∏Å‡∏≥‡∏•‡∏±‡∏á calibrate | ‡∏£‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à |
| üü¢ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß | ‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡∏á‡∏ó‡∏µ‡πà | Ready (‡∏Å‡πà‡∏≠‡∏ô START) | ‡∏õ‡∏Å‡∏ï‡∏¥, ‡∏Å‡∏î START ‡πÑ‡∏î‡πâ |
| üîµ ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô | ‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡∏á‡∏ó‡∏µ‡πà | Running | ‡∏õ‡∏Å‡∏ï‡∏¥ |

---

## Diagnostic Tools

### 1. Serial Monitor Check

```
> S
Motor started

> M1
Mode: Position Control with S-Curve

> #0
S-Curve setpoint: 0.0
Returns:    0.1    0.0

‚Üí ‡∏ñ‡πâ‡∏≤‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô = ‡∏õ‡∏Å‡∏ï‡∏¥
```

### 2. Encoder Test

```cpp
// ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô main.cpp (loop)
Serial.print("Raw Angle: ");
Serial.println(encoder.getAngle());
delay(100);

‚Üí ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡∏°‡∏∏‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå
```

### 3. Motor Phase Test

```cpp
// Open-loop test (‡∏£‡∏∞‡∏ß‡∏±‡∏á: ‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏à‡∏∞‡∏´‡∏°‡∏∏‡∏ô!)
vd = 0;
vq = 5.0;  // ‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≥‡πÜ
electricalAngle += 0.01;

‚Üí ‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏Ñ‡∏ß‡∏£‡∏´‡∏°‡∏∏‡∏ô‡∏ä‡πâ‡∏≤‡πÜ
```

### 4. Voltage Measurement

```
‡πÉ‡∏ä‡πâ multimeter ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:
- V_MOTOR: 24V
- 3.3V Rail: 3.3V
- 5V Rail: 5.0V (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
- Encoder VDD: 3.3V or 5.0V
```

---

## üîç Debug Checklist

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏à‡∏≠‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡∏ó‡∏≥‡∏ï‡∏≤‡∏° checklist ‡∏ô‡∏µ‡πâ:

### Hardware
- [ ] Power supply 24V ‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£
- [ ] 3.3V logic ‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£
- [ ] Encoder ‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á (‡∏≠‡πà‡∏≤‡∏ô‡∏°‡∏∏‡∏°‡πÑ‡∏î‡πâ)
- [ ] Motor phase ‡∏ï‡πà‡∏≠‡∏ñ‡∏π‡∏Å (‡πÑ‡∏°‡πà short)
- [ ] LED ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
- [ ] START button ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

### Communication
- [ ] Serial Monitor ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ (baud 921600)
- [ ] ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° initialization
- [ ] ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á ASCII ‡πÑ‡∏î‡πâ
- [ ] Binary mode toggle ‡πÑ‡∏î‡πâ

### Motor
- [ ] ‡∏Å‡∏î START ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡πà‡∏á 'S' ‡πÅ‡∏•‡πâ‡∏ß
- [ ] LED ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
- [ ] ‡πÄ‡∏´‡πá‡∏ô feedback "Returns: X Y"

---

## üìû ‡∏¢‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ?

1. **‡∏î‡∏π‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°:**
   - [Hardware Setup](HARDWARE_SETUP.md)
   - [User Guide](../getting-started/USER_GUIDE.md)

2. **‡∏ñ‡∏≤‡∏° Community:**
   - GitHub Issues
   - GitHub Discussions

3. **‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ Support:**
   - Email: [maintainer email]
   - Discord: [if available]

---

**Last Updated:** December 20, 2025  
**Version:** 1.0
